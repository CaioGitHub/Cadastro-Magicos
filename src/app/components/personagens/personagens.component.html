<div class="personagens-container">
  <h2>🛡️ Cadastro de Personagens 🐉</h2>

  <!-- 🧾 Formulário -->
  <form class="panel" (ngSubmit)="salvarPersonagem()">
    <div class="form-group">
      <label>Nome</label>
      <input [(ngModel)]="novoPersonagem.nome" name="nome" required />
    </div>

    <div class="form-group">
      <label>Raça</label>
      <input [(ngModel)]="novoPersonagem.raca" name="raca" required />
    </div>

    <div class="form-group">
      <label>Nível</label>
      <input [(ngModel)]="novoPersonagem.nivel" name="nivel" type="number" required />
    </div>

    <div class="form-group">
      <label>Cor de Fundo</label>
      <input [(ngModel)]="novoPersonagem.cor" name="cor" type="color" />
    </div>

    <div class="form-group">
      <label>URL da Imagem</label>
      <input [(ngModel)]="novoPersonagem.imagem" name="imagem" placeholder="https://…" />
      <small *ngIf="!isImagemValida(novoPersonagem.imagem)">
        Dica: use uma URL começando com http:// ou https://
      </small>
    </div>

    <button type="submit" class="rpg-btn">
      {{ editando ? 'Salvar Alterações' : 'Adicionar Personagem' }}
    </button>
  </form>

  <!-- 💎 Lista de Personagens -->
  <div class="cards">
    <div class="card" *ngFor="let p of personagens; let i = index" [style.backgroundColor]="p.cor">
      <img
        [src]="p.imagem && p.imagem.trim() !== '' ? p.imagem : placeholder"
        (error)="onImgError($event)"
        [alt]="p.nome"
        loading="lazy"
        referrerpolicy="no-referrer"
      />
      <h3>{{ p.nome }}</h3>
      <p>Raça: {{ p.raca }}</p>
      <p>Nível: {{ p.nivel }}</p>

      <div class="card-buttons">
        <button type="button" class="edit-btn" (click)="editarPersonagem(i)">✏️ Editar</button>
        <button type="button" class="delete-btn" (click)="removerPersonagem(i)">🗑️ Excluir</button>
      </div>
    </div>
  </div>

  <!-- 🧹 Limpar tudo -->
  <div class="flex justify-center mt-4">
    <button class="delete-btn" (click)="limparTudo()">🧹 Limpar Todos</button>
  </div>
</div>
